@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
    ViewBag.Title = "Post Detail";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@using ZAlpha.Application.Comment.Queries.GetComment;
@using ZAlpha.Application.Common.Models;
@using ZAlpha.Application.Post.Queries.GetAllPost;
@using ZAlpha.Application.Comment.Queries.GetAllComment;
@using ZAlpha.Domain.Enums;
@using ZAlpha.Application.Utils.FormatDate;
@model PostModel;
@{
    PaginatedList<CommentModel> listComment = ViewBag.listComment;
}


<!-- CONTENT GRID -->
<div class="content-grid">
    <!-- GRID -->
    <div class="grid">
        <!-- GRID -->
        <div class="grid grid-half change-on-desktop">
            <!-- WIDGET BOX -->
            <div class="widget-box no-padding">
                <!-- WIDGET BOX SETTINGS -->
                <div class="widget-box-settings">
                    <!-- POST SETTINGS WRAP -->
                    <div class="post-settings-wrap">
                        <!-- POST SETTINGS -->
                        <div class="post-settings widget-box-post-settings-dropdown-trigger">
                            <!-- POST SETTINGS ICON -->
                            <svg class="post-settings-icon icon-more-dots">
                                <use xlink:href="#svg-more-dots"></use>
                            </svg>
                            <!-- /POST SETTINGS ICON -->
                        </div>
                        <!-- /POST SETTINGS -->
                        <!-- SIMPLE DROPDOWN -->
                        <div class="simple-dropdown widget-box-post-settings-dropdown">
                            <!-- SIMPLE DROPDOWN LINK -->
                            <p class="simple-dropdown-link">Edit Post</p>
                            <!-- /SIMPLE DROPDOWN LINK -->
                            <!-- SIMPLE DROPDOWN LINK -->
                            <p class="simple-dropdown-link">Delete Post</p>
                            <!-- /SIMPLE DROPDOWN LINK -->
                            <!-- SIMPLE DROPDOWN LINK -->
                            <p class="simple-dropdown-link">Make it Featured</p>
                            <!-- /SIMPLE DROPDOWN LINK -->
                            <!-- SIMPLE DROPDOWN LINK -->
                            <p class="simple-dropdown-link">Report Post</p>
                            <!-- /SIMPLE DROPDOWN LINK -->
                            <!-- SIMPLE DROPDOWN LINK -->
                            <p class="simple-dropdown-link">Report Author</p>
                            <!-- /SIMPLE DROPDOWN LINK -->
                        </div>
                        <!-- /SIMPLE DROPDOWN -->
                    </div>
                    <!-- /POST SETTINGS WRAP -->
                </div>
                <!-- /WIDGET BOX SETTINGS -->
                <!-- WIDGET BOX STATUS -->
                <div class="widget-box-status">
                    <!-- TEXT STICKER -->
                    @*  <p class="text-sticker medium round">
                    <!-- TEXT STICKER ICON -->
                    <svg class="text-sticker-icon icon-trophy">
                    <use xlink:href="#svg-trophy"></use>
                    </svg>
                    <!-- TEXT STICKER ICON -->

                    <!-- TEXT STICKER CONTENT -->
                    <span class="text-sticker-content">Most Popular Post</span>
                    <!-- /TEXT STICKER CONTENT -->
                    </p> *@
                    <!-- /TEXT STICKER -->
                    <!-- WIDGET BOX STATUS CONTENT -->
                    <div class="widget-box-status-content">
                        <!-- USER STATUS -->
                        <div class="user-status">
                            <!-- USER STATUS AVATAR -->
                            <a class="user-status-avatar">
                                <!-- USER AVATAR -->
                                <div class="user-avatar small no-outline">
                                    <!-- USER AVATAR CONTENT -->
                                    <div class="user-avatar-content">
                                        <!-- HEXAGON -->
                                        @{
                                            var imgUserPostUrl = Model.InteractWithPosts?.FirstOrDefault(o => o.InteractPostStatus == InteractPostStatus.Create).UserAccount.AvatarUrl;
                                        }
                                        @if (imgUserPostUrl != null && Model.AnonymousStatus == AnonymousStatus.UnActive)
                                        {
                                            <div class="hexagon-image-30-32" data-src="@imgUserPostUrl"></div>
                                        }
                                        else
                                        {
                                            <div class="hexagon-image-30-32" data-src="https://cdn1.iconfinder.com/data/icons/user-pictures/100/unknown-512.png"></div>
                                        }
                                        
                                        <!-- /HEXAGON -->
                                    </div>
                                    <!-- /USER AVATAR CONTENT -->
                                    <!-- USER AVATAR PROGRESS -->
                                    <div class="user-avatar-progress">
                                        <!-- HEXAGON -->
                                        <div class="hexagon-progress-40-44"></div>
                                        <!-- /HEXAGON -->
                                    </div>
                                    <!-- /USER AVATAR PROGRESS -->
                                    <!-- USER AVATAR PROGRESS BORDER -->
                                    <div class="user-avatar-progress-border">
                                        <!-- HEXAGON -->
                                        <div class="hexagon-border-40-44"></div>
                                        <!-- /HEXAGON -->
                                    </div>
                                    <!-- /USER AVATAR PROGRESS BORDER -->

                                </div>
                                <!-- /USER AVATAR -->
                            </a>
                            <!-- /USER STATUS AVATAR -->
                            <!-- USER STATUS TITLE -->
                            <p class="user-status-title medium">
                                @{
                                    var linkUser = "Route/InfomationDetail?userId=" + Model.InteractWithPosts?.FirstOrDefault(o => o.InteractPostStatus == InteractPostStatus.Create)?.UserAccount.Id;
                                }
                                @if (Model.AnonymousStatus == ZAlpha.Domain.Enums.AnonymousStatus.Active)
                                {
                                    <a class="bold">
                                        Ẩn danh
                                    </a>
                                }
                                else
                                {
                                    <a class="bold" href="@linkUser">
                                        @Model.InteractWithPosts?.FirstOrDefault(o => o.InteractPostStatus == InteractPostStatus.Create).UserAccount.FirstName
                                        @Model.InteractWithPosts?.FirstOrDefault(o => o.InteractPostStatus == InteractPostStatus.Create).UserAccount.LastName
                                    </a>
                                }
                            </p>
                            <!-- /USER STATUS TITLE -->
                            <!-- USER STATUS TEXT -->
                            <p class="user-status-text small">@FormatDate.CalTimeBetweenTwoDate(Model.Created)</p>
                            <!-- /USER STATUS TEXT -->
                        </div>
                        <!-- /USER STATUS -->
                        <!-- WIDGET BOX STATUS TEXT -->
                        <p class="widget-box-status-text">
                            @Model.PostBody
                        </p>
                        <!-- /WIDGET BOX STATUS TEXT -->
                        @if (Model.PostImagesUrl?.Length > 0)
                        {
                            <img class="video-status-image" style="width:100%;" src="@Model.PostImagesUrl" alt="cover-50" />
                        }
                      
                        @* <!-- VIDEO STATUS -->
                        <a class="video-status" href="https://www.youtube.com/" target="_blank">
                        <!-- VIDEO STATUS IMAGE -->
                        <img class="video-status-image" src="img/cover/50.jpg" alt="cover-50">
                        <!-- /VIDEO STATUS IMAGE -->

                        <!-- VIDEO STATUS INFO -->
                        <div class="video-status-info">
                        <!-- VIDEO STATUS META -->
                        <p class="video-status-meta">youtube.com</p>
                        <!-- /VIDEO STATUS META -->

                        <!-- VIDEO STATUS TITLE -->
                        <p class="video-status-title"><span class="bold">GameHuntress</span> on <span class="highlighted">Youtube</span></p>
                        <!-- /VIDEO STATUS TITLE -->

                        <!-- VIDEO STATUS TEXT -->
                        <p class="video-status-text">Watch the GameHuntress play all the greatest games.</p>
                        <!-- /VIDEO STATUS TEXT -->
                        </div>
                        <!-- /VIDEO STATUS INFO -->
                        </a>
                        <!-- /VIDEO STATUS --> *@

                        <!-- TAG LIST -->
                        <div class="tag-list">
                            @foreach (var tag in Model.PostTags)
                            {
                                <!-- TAG ITEM -->
                                <a class="tag-item secondary" href="newsfeed.html">@tag.Tag.TagName</a>
                                <!-- /TAG ITEM -->
                            }
                        </div>
                        <!-- /TAG LIST -->
                        <!-- CONTENT ACTIONS -->
                        <div class="content-actions">
                            @{
                                var allReactionToName = Model.InteractWithPosts?
                                .Where(i => i.InteractPostStatus != ZAlpha.Domain.Enums.InteractPostStatus.Create)
                                .OrderBy(i => i.Created)
                                .ToList();
                                var top3reactionPost = Model.InteractWithPosts?
                                .Where(i => i.InteractPostStatus != ZAlpha.Domain.Enums.InteractPostStatus.Create)
                                .OrderByDescending(i => i.InteractPostStatus)
                                .DistinctBy(i => i.InteractPostStatus)
                                .Take(3)
                                .ToList();
                                var top3reactionPostRevert = new List<ZAlpha.Domain.Entities.InteractWithPosts>();
                                foreach (var post in top3reactionPost)
                                {
                                    top3reactionPostRevert.Add(post);
                                }
                            }
                            <!-- CONTENT ACTION -->
                            <div class="content-action">
                                <!-- META LINE -->
                                <div class="meta-line">
                                    <!-- META LINE LIST -->
                                    <div class="meta-line-list reaction-item-list">
                                        @foreach (var post in top3reactionPostRevert)
                                        {
                                            <!-- REACTION ITEM -->
                                            <div class="reaction-item">
                                                <!-- REACTION IMAGE -->
                                                @{
                                                    if (post.InteractPostStatus == ZAlpha.Domain.Enums.InteractPostStatus.Like)
                                                    {
                                                        <img class="reaction-image reaction-item-dropdown-trigger" src="~/assets/images/reaction/like.png" alt="reaction-like">
                                                    }
                                                    else if (post.InteractPostStatus == ZAlpha.Domain.Enums.InteractPostStatus.Love)
                                                    {
                                                        <img class="reaction-image reaction-item-dropdown-trigger" src="~/assets/images/reaction/love.png" alt="reaction-love">
                                                    }
                                                    else if (post.InteractPostStatus == ZAlpha.Domain.Enums.InteractPostStatus.Dislike)
                                                    {
                                                        <img class="reaction-image reaction-item-dropdown-trigger" src="~/assets/images/reaction/dislike.png" alt="reaction-dislike">
                                                    }
                                                    else if (post.InteractPostStatus == ZAlpha.Domain.Enums.InteractPostStatus.Happy)
                                                    {
                                                        <img class="reaction-image reaction-item-dropdown-trigger" src="~/assets/images/reaction/happy.png" alt="reaction-happy">
                                                    }
                                                    else if (post.InteractPostStatus == ZAlpha.Domain.Enums.InteractPostStatus.Funny)
                                                    {
                                                        <img class="reaction-image reaction-item-dropdown-trigger" src="~/assets/images/reaction/funny.png" alt="reaction-funny">
                                                    }
                                                    else if (post.InteractPostStatus == ZAlpha.Domain.Enums.InteractPostStatus.Wow)
                                                    {
                                                        <img class="reaction-image reaction-item-dropdown-trigger" src="~/assets/images/reaction/wow.png" alt="reaction-wow">
                                                    }
                                                    else if (post.InteractPostStatus == ZAlpha.Domain.Enums.InteractPostStatus.Angry)
                                                    {
                                                        <img class="reaction-image reaction-item-dropdown-trigger" src="~/assets/images/reaction/angry.png" alt="reaction-angry">
                                                    }
                                                    else if (post.InteractPostStatus == ZAlpha.Domain.Enums.InteractPostStatus.Sad)
                                                    {
                                                        <img class="reaction-image reaction-item-dropdown-trigger" src="~/assets/images/reaction/sad.png" alt="reaction-sad">
                                                    }
                                                }
                                                <!-- /REACTION IMAGE -->
                                                <!-- SIMPLE DROPDOWN -->
                                                <div class="simple-dropdown padded reaction-item-dropdown">
                                                    <!-- SIMPLE DROPDOWN TEXT -->
                                                    @{
                                                        if (post.InteractPostStatus == ZAlpha.Domain.Enums.InteractPostStatus.Like)
                                                        {
                                                            <p class="simple-dropdown-text">
                                                                <img class="reaction" src="~/assets/images/reaction/like.png" alt="reaction-like">
                                                                <span class="bold">Like</span>
                                                            </p>
                                                        }
                                                        else if (post.InteractPostStatus == ZAlpha.Domain.Enums.InteractPostStatus.Love)
                                                        {
                                                            <p class="simple-dropdown-text">
                                                                <img class="reaction" src="~/assets/images/reaction/love.png" alt="reaction-love">
                                                                <span class="bold">Love</span>
                                                            </p>
                                                        }
                                                        else if (post.InteractPostStatus == ZAlpha.Domain.Enums.InteractPostStatus.Dislike)
                                                        {
                                                            <p class="simple-dropdown-text">
                                                                <img class="reaction" src="~/assets/images/reaction/dislike.png" alt="reaction-dislike">
                                                                <span class="bold">Dislike</span>
                                                            </p>
                                                        }
                                                        else if (post.InteractPostStatus == ZAlpha.Domain.Enums.InteractPostStatus.Happy)
                                                        {
                                                            <p class="simple-dropdown-text">
                                                                <img class="reaction" src="~/assets/images/reaction/happy.png" alt="reaction-happy">
                                                                <span class="bold">Happy</span>
                                                            </p>
                                                        }
                                                        else if (post.InteractPostStatus == ZAlpha.Domain.Enums.InteractPostStatus.Funny)
                                                        {
                                                            <p class="simple-dropdown-text">
                                                                <img class="reaction" src="~/assets/images/reaction/funny.png" alt="reaction-funny">
                                                                <span class="bold">Funny</span>
                                                            </p>
                                                        }
                                                        else if (post.InteractPostStatus == ZAlpha.Domain.Enums.InteractPostStatus.Wow)
                                                        {
                                                            <p class="simple-dropdown-text">
                                                                <img class="reaction" src="~/assets/images/reaction/wow.png" alt="reaction-wow">
                                                                <span class="bold">Wow</span>
                                                            </p>
                                                        }
                                                        else if (post.InteractPostStatus == ZAlpha.Domain.Enums.InteractPostStatus.Angry)
                                                        {
                                                            <p class="simple-dropdown-text">
                                                                <img class="reaction" src="~/assets/images/reaction/angry.png" alt="reaction-angry">
                                                                <span class="bold">Angry</span>
                                                            </p>
                                                        }
                                                        else if (post.InteractPostStatus == ZAlpha.Domain.Enums.InteractPostStatus.Sad)
                                                        {
                                                            <p class="simple-dropdown-text">
                                                                <img class="reaction" src="~/assets/images/reaction/sad.png" alt="reaction-sad">
                                                                <span class="bold">Sad</span>
                                                            </p>
                                                        }
                                                    }
                                                    <!-- /SIMPLE DROPDOWN TEXT -->
                                                    @foreach (var interactName in allReactionToName)
                                                    {
                                                        if (post.InteractPostStatus == interactName.InteractPostStatus)
                                                        {
                                                            <!-- SIMPLE DROPDOWN TEXT -->
                                                            <p class="simple-dropdown-text">@interactName.UserAccount.FirstName @interactName.UserAccount.LastName</p>
                                                            <!-- /SIMPLE DROPDOWN TEXT -->
                                                        }
                                                    }
                                                    @* <!-- SIMPLE DROPDOWN TEXT -->
                                                <p class="simple-dropdown-text"><span class="bold">and 6 more...</span></p>
                                                <!-- /SIMPLE DROPDOWN TEXT --> *@
                                                </div>
                                                <!-- /SIMPLE DROPDOWN -->
                                            </div>
                                            <!-- /REACTION ITEM -->
                                        }
                                    </div>
                                    <!-- /META LINE LIST -->
                                    <!-- META LINE TEXT -->
                                    <p class="meta-line-text">
                                        @Model.InteractWithPosts?.Where(i =>
                                        i.InteractPostStatus != ZAlpha.Domain.Enums.InteractPostStatus.Create).Count()
                                    </p>
                                    <!-- /META LINE TEXT -->
                                </div>
                                <!-- /META LINE -->
                            </div>
                            <!-- /CONTENT ACTION -->


                            <!-- CONTENT ACTION -->
                            <div class="content-action">
                                <!-- META LINE -->
                                <div class="meta-line">
                                    <!-- META LINE LINK -->
                                    <a href="~/Post?postId=@Model.Id">
                                        <p class="meta-line-link">@Model.Comments?.Where(w => w.IsDeleted == false).Count() bình luận</p>
                                    </a>
                                    <!-- /META LINE LINK -->
                                </div>
                                <!-- /META LINE -->
                                <!-- META LINE -->
                                <div class="meta-line">
                                    <!-- META LINE TEXT -->
                                    <p class="meta-line-text">@Model.WishListPosts?.Where(w => w.IsDeleted == false).Count() lưu</p>
                                    <!-- /META LINE TEXT -->
                                </div>
                                <!-- /META LINE -->
                            </div>
                            <!-- /CONTENT ACTION -->


                        </div>
                        <!-- /CONTENT ACTIONS -->
                    </div>
                    <!-- /WIDGET BOX STATUS CONTENT -->
                </div>
                <!-- /WIDGET BOX STATUS -->
                <!-- POST OPTIONS -->
                <div class="post-options">
                    <!-- POST OPTION WRAP -->
                    <div class="post-option-wrap">
                        @{
                            var interactedPostbyUser = Model.InteractWithPosts?.FirstOrDefault(i =>
                            i.InteractPostStatus != ZAlpha.Domain.Enums.InteractPostStatus.Create
                            && i.UserAccount.UserName == User.Identity.Name);
                            if (interactedPostbyUser != null)
                            {
                                if (interactedPostbyUser.InteractPostStatus == ZAlpha.Domain.Enums.InteractPostStatus.Like)
                                {
                                    <!-- POST OPTION -->
                                    <div class="post-option reaction-options-dropdown-trigger">
                                        <!-- POST OPTION ICON -->
                                        <img class="post-option-icon icon-thumbs-up" src="~/assets/images/reaction/like.png" alt="reaction-like">
                                        <!-- /POST OPTION ICON -->
                                        <!-- POST OPTION TEXT -->
                                        <p class="post-option-text">Like</p>
                                        <!-- /POST OPTION TEXT -->
                                    </div>
                                    <!-- /POST OPTION -->
                                }
                                else if (interactedPostbyUser.InteractPostStatus == ZAlpha.Domain.Enums.InteractPostStatus.Dislike)
                                {
                                    <!-- POST OPTION -->
                                    <div class="post-option reaction-options-dropdown-trigger">
                                        <!-- POST OPTION ICON -->
                                        <img class="post-option-icon icon-thumbs-up" src="~/assets/images/reaction/dislike.png" alt="reaction-dislike">
                                        <!-- /POST OPTION ICON -->
                                        <!-- POST OPTION TEXT -->
                                        <p class="post-option-text">Dislike</p>
                                        <!-- /POST OPTION TEXT -->
                                    </div>
                                    <!-- /POST OPTION -->
                                }
                                else if (interactedPostbyUser.InteractPostStatus == ZAlpha.Domain.Enums.InteractPostStatus.Sad)
                                {
                                    <!-- POST OPTION -->
                                    <div class="post-option reaction-options-dropdown-trigger">
                                        <!-- POST OPTION ICON -->
                                        <img class="post-option-icon icon-thumbs-up" src="~/assets/images/reaction/sad.png" alt="reaction-sad">
                                        <!-- /POST OPTION ICON -->
                                        <!-- POST OPTION TEXT -->
                                        <p class="post-option-text">Sad</p>
                                        <!-- /POST OPTION TEXT -->
                                    </div>
                                    <!-- /POST OPTION -->
                                }
                                else if (interactedPostbyUser.InteractPostStatus == ZAlpha.Domain.Enums.InteractPostStatus.Funny)
                                {
                                    <!-- POST OPTION -->
                                    <div class="post-option reaction-options-dropdown-trigger">
                                        <!-- POST OPTION ICON -->
                                        <img class="post-option-icon icon-thumbs-up" src="~/assets/images/reaction/funny.png" alt="reaction-funny">
                                        <!-- /POST OPTION ICON -->
                                        <!-- POST OPTION TEXT -->
                                        <p class="post-option-text">Funny</p>
                                        <!-- /POST OPTION TEXT -->
                                    </div>
                                    <!-- /POST OPTION -->
                                }
                                else if (interactedPostbyUser.InteractPostStatus == ZAlpha.Domain.Enums.InteractPostStatus.Angry)
                                {
                                    <!-- POST OPTION -->
                                    <div class="post-option reaction-options-dropdown-trigger">
                                        <!-- POST OPTION ICON -->
                                        <img class="post-option-icon icon-thumbs-up" src="~/assets/images/reaction/angry.png" alt="reaction-angry">
                                        <!-- /POST OPTION ICON -->
                                        <!-- POST OPTION TEXT -->
                                        <p class="post-option-text">Angry</p>
                                        <!-- /POST OPTION TEXT -->
                                    </div>
                                    <!-- /POST OPTION -->
                                }
                                else if (interactedPostbyUser.InteractPostStatus == ZAlpha.Domain.Enums.InteractPostStatus.Love)
                                {
                                    <!-- POST OPTION -->
                                    <div class="post-option reaction-options-dropdown-trigger">
                                        <!-- POST OPTION ICON -->
                                        <img class="post-option-icon icon-thumbs-up" src="~/assets/images/reaction/love.png" alt="reaction-love">
                                        <!-- /POST OPTION ICON -->
                                        <!-- POST OPTION TEXT -->
                                        <p class="post-option-text">Love</p>
                                        <!-- /POST OPTION TEXT -->
                                    </div>
                                    <!-- /POST OPTION -->
                                }
                                else if (interactedPostbyUser.InteractPostStatus == ZAlpha.Domain.Enums.InteractPostStatus.Happy)
                                {
                                    <!-- POST OPTION -->
                                    <div class="post-option reaction-options-dropdown-trigger">
                                        <!-- POST OPTION ICON -->
                                        <img class="post-option-icon icon-thumbs-up" src="~/assets/images/reaction/happy.png" alt="reaction-happy">
                                        <!-- /POST OPTION ICON -->
                                        <!-- POST OPTION TEXT -->
                                        <p class="post-option-text">Happy</p>
                                        <!-- /POST OPTION TEXT -->
                                    </div>
                                    <!-- /POST OPTION -->
                                }
                                else if (interactedPostbyUser.InteractPostStatus == ZAlpha.Domain.Enums.InteractPostStatus.Wow)
                                {
                                    <!-- POST OPTION -->
                                    <div class="post-option reaction-options-dropdown-trigger">
                                        <!-- POST OPTION ICON -->
                                        <img class="post-option-icon icon-thumbs-up" src="~/assets/images/reaction/wow.png" alt="reaction-wow">
                                        <!-- /POST OPTION ICON -->
                                        <!-- POST OPTION TEXT -->
                                        <p class="post-option-text">Wow</p>
                                        <!-- /POST OPTION TEXT -->
                                    </div>
                                    <!-- /POST OPTION -->
                                }
                            }
                            else
                            {
                                <!-- POST OPTION -->
                                <div class="post-option reaction-options-dropdown-trigger">
                                    <!-- POST OPTION ICON -->
                                    <svg class="post-option-icon icon-thumbs-up">
                                        <use xlink:href="#svg-thumbs-up"></use>
                                    </svg>
                                    <!-- /POST OPTION ICON -->
                                    <!-- POST OPTION TEXT -->
                                    <p class="post-option-text">Tương tác !</p>
                                    <!-- /POST OPTION TEXT -->
                                </div>
                                <!-- /POST OPTION -->
                            }
                        }
                        <!-- REACTION OPTIONS -->
                        <div class="reaction-options reaction-options-dropdown" style="position: absolute; z-index: 9999; bottom: 54px; left: -16px; opacity: 0; visibility: hidden; transform: translate(0px, 20px); transition: transform 0.3s ease-in-out 0s, opacity 0.3s ease-in-out 0s, visibility 0.3s ease-in-out 0s;">
                            <!-- REACTION OPTION -->
                            <div onclick="interactWithPost('@Model.Id.ToString()', 'Like')" class="reaction-option text-tooltip-tft" data-title="Like" style="position: relative;">
                                <!-- REACTION OPTION IMAGE -->
                                <img class="reaction-option-image" src="~/assets/images/reaction/like.png" alt="reaction-like">
                                <!-- /REACTION OPTION IMAGE -->
                                <div class="xm-tooltip" style="white-space: nowrap; position: absolute; z-index: 99999; top: -28px; left: 50%; margin-left: -22px; opacity: 0; visibility: hidden; transform: translate(0px, 10px); transition: all 0.3s ease-in-out 0s;"><p class="xm-tooltip-text">Like</p></div>
                            </div>
                            <!-- /REACTION OPTION -->
                            <!-- REACTION OPTION -->
                            <div onclick="interactWithPost('@Model.Id.ToString()', 'Love')" class="reaction-option text-tooltip-tft" data-title="Love" style="position: relative;">
                                <!-- REACTION OPTION IMAGE -->
                                <img class="reaction-option-image" src="~/assets/images/reaction/love.png" alt="reaction-love">
                                <!-- /REACTION OPTION IMAGE -->
                                <div class="xm-tooltip" style="white-space: nowrap; position: absolute; z-index: 99999; top: -28px; left: 50%; margin-left: -23.5px; opacity: 0; visibility: hidden; transform: translate(0px, 10px); transition: all 0.3s ease-in-out 0s;"><p class="xm-tooltip-text">Love</p></div>
                            </div>
                            <!-- /REACTION OPTION -->
                            <!-- REACTION OPTION -->
                            <div onclick="interactWithPost('@Model.Id.ToString()', 'Dislike')" class="reaction-option text-tooltip-tft" data-title="Dislike" style="position: relative;">
                                <!-- REACTION OPTION IMAGE -->
                                <img class="reaction-option-image" src="~/assets/images/reaction/dislike.png" alt="reaction-dislike">
                                <!-- /REACTION OPTION IMAGE -->
                                <div class="xm-tooltip" style="white-space: nowrap; position: absolute; z-index: 99999; top: -28px; left: 50%; margin-left: -28px; opacity: 0; visibility: hidden; transform: translate(0px, 10px); transition: all 0.3s ease-in-out 0s;"><p class="xm-tooltip-text">Dislike</p></div>
                            </div>
                            <!-- /REACTION OPTION -->
                            <!-- REACTION OPTION -->
                            <div onclick="interactWithPost('@Model.Id.ToString()', 'Happy')" class="reaction-option text-tooltip-tft" data-title="Happy" style="position: relative;">
                                <!-- REACTION OPTION IMAGE -->
                                <img class="reaction-option-image" src="~/assets/images/reaction/happy.png" alt="reaction-happy">
                                <!-- /REACTION OPTION IMAGE -->
                                <div class="xm-tooltip" style="white-space: nowrap; position: absolute; z-index: 99999; top: -28px; left: 50%; margin-left: -27.5px; opacity: 0; visibility: hidden; transform: translate(0px, 10px); transition: all 0.3s ease-in-out 0s;"><p class="xm-tooltip-text">Happy</p></div>
                            </div>
                            <!-- /REACTION OPTION -->
                            <!-- REACTION OPTION -->
                            <div onclick="interactWithPost('@Model.Id.ToString()', 'Funny')" class="reaction-option text-tooltip-tft" data-title="Funny" style="position: relative;">
                                <!-- REACTION OPTION IMAGE -->
                                <img class="reaction-option-image" src="~/assets/images/reaction/funny.png" alt="reaction-funny">
                                <!-- /REACTION OPTION IMAGE -->
                                <div class="xm-tooltip" style="white-space: nowrap; position: absolute; z-index: 99999; top: -28px; left: 50%; margin-left: -27px; opacity: 0; visibility: hidden; transform: translate(0px, 10px); transition: all 0.3s ease-in-out 0s;"><p class="xm-tooltip-text">Funny</p></div>
                            </div>
                            <!-- /REACTION OPTION -->
                            <!-- REACTION OPTION -->
                            <div onclick="interactWithPost('@Model.Id.ToString()', 'Wow')" class="reaction-option text-tooltip-tft" data-title="Wow" style="position: relative;">
                                <!-- REACTION OPTION IMAGE -->
                                <img class="reaction-option-image" src="~/assets/images/reaction/wow.png" alt="reaction-wow">
                                <!-- /REACTION OPTION IMAGE -->
                                <div class="xm-tooltip" style="white-space: nowrap; position: absolute; z-index: 99999; top: -28px; left: 50%; margin-left: -24px; opacity: 0; visibility: hidden; transform: translate(0px, 10px); transition: all 0.3s ease-in-out 0s;"><p class="xm-tooltip-text">Wow</p></div>
                            </div>
                            <!-- /REACTION OPTION -->
                            <!-- REACTION OPTION -->
                            <div onclick="interactWithPost('@Model.Id.ToString()', 'Angry')" class="reaction-option text-tooltip-tft" data-title="Angry" style="position: relative;">
                                <!-- REACTION OPTION IMAGE -->
                                <img class="reaction-option-image" src="~/assets/images/reaction/angry.png" alt="reaction-angry">
                                <!-- /REACTION OPTION IMAGE -->
                                <div class="xm-tooltip" style="white-space: nowrap; position: absolute; z-index: 99999; top: -28px; left: 50%; margin-left: -26.5px; opacity: 0; visibility: hidden; transform: translate(0px, 10px); transition: all 0.3s ease-in-out 0s;"><p class="xm-tooltip-text">Angry</p></div>
                            </div>
                            <!-- /REACTION OPTION -->
                            <!-- REACTION OPTION -->
                            <div onclick="interactWithPost('@Model.Id.ToString()', 'Sad')" class="reaction-option text-tooltip-tft" data-title="Sad" style="position: relative;">
                                <!-- REACTION OPTION IMAGE -->
                                <img class="reaction-option-image" src="~/assets/images/reaction/sad.png" alt="reaction-sad">
                                <!-- /REACTION OPTION IMAGE -->
                                <div class="xm-tooltip" style="white-space: nowrap; position: absolute; z-index: 99999; top: -28px; left: 50%; margin-left: -21.5px; opacity: 0; visibility: hidden; transform: translate(0px, 10px); transition: all 0.3s ease-in-out 0s;"><p class="xm-tooltip-text">Sad</p></div>
                            </div>
                            <!-- /REACTION OPTION -->
                        </div>
                        <!-- /REACTION OPTIONS -->
                    </div>
                    <!-- /POST OPTION WRAP -->
                    <!-- POST OPTION -->
                    <a href="~/Post?postId=@Model.Id">
                        <div class="post-option">
                            <!-- POST OPTION ICON -->
                            <svg class="post-option-icon icon-comment">
                                <use xlink:href="#svg-comment"></use>
                            </svg>
                            <!-- /POST OPTION ICON -->
                            <!-- POST OPTION TEXT -->
                            <p class="post-option-text">Xem chi tiết</p>
                            <!-- /POST OPTION TEXT -->
                        </div>
                    </a>
                    <!-- /POST OPTION -->
                    @{
                        if (Model
                        .WishListPosts?
                        .FirstOrDefault(w => w.UserAccount.UserName == User.Identity.Name
                        && w.IsDeleted == false) != null)
                        {
                            <!-- POST OPTION -->
                            <div class="post-option" onclick="savePost('@Model.Id', 'true')">
                                <!-- POST OPTION ICON -->

                                <svg class=" post-option-icon icon-pinned">
                                    <use xlink:href="#svg-pinned"></use>
                                </svg>
                                <!-- /POST OPTION ICON -->
                                <!-- POST OPTION TEXT -->
                                <p class="post-option-text">Bỏ lưu</p>
                                <!-- /POST OPTION TEXT -->
                            </div>
                            <!-- /POST OPTION -->
                        }
                        else
                        {
                            <!-- POST OPTION -->
                            <div class="post-option" onclick="savePost('@Model.Id', 'false')">
                                <!-- POST OPTION ICON -->
                                <svg class=" post-option-icon icon-pinned">
                                    <use xlink:href="#svg-pinned"></use>
                                </svg>
                                <!-- /POST OPTION ICON -->
                                <!-- POST OPTION TEXT -->
                                <p class="post-option-text">Lưu</p>
                                <!-- /POST OPTION TEXT -->
                            </div>
                            <!-- /POST OPTION -->
                        }
                    }
                </div>
                <!-- /POST OPTIONS -->
            </div>
            <!-- /WIDGET BOX -->
            <!-- WIDGET BOX -->
            <div class="widget-box no-padding">
                <!-- WIDGET BOX TITLE -->
                <p class="widget-box-title">Bình luận</p>
                <!-- /WIDGET BOX TITLE -->
                <!-- WIDGET BOX CONTENT -->
                <div class="widget-box-content padded-for-scroll medium" data-simplebar>
                    <!-- USER STATUS LIST -->
                    <div class="user-status-list scroll-content">

                        @foreach (var comment in listComment.Items)
                        {
                            <!-- USER STATUS -->
                            <div class="user-status">
                                <!-- USER STATUS ACTIVITY -->
                                <div class="user-status-activity activity-reaction">
                                    <!-- USER STATUS ACTIVITY ICON -->
                                    @*   <svg class="user-status-activity-icon icon-thumbs-up">
                                        <use xlink:href="#svg-thumbs-up"></use>
                                    </svg>  *@
                                    <!-- /USER STATUS ACTIVITY ICON -->
                                    @{
                                        var imgUrl = comment.InteractWithComments?.FirstOrDefault(o => o.InteractCommentStatus == InteractCommentStatus.Create)?.UserAccount.AvatarUrl;
                                    }
                                    @if(imgUrl != null){
                                        <img src="@imgUrl" style="width:100%; height:100%;border-radius: 50%; " />
                                    }
                                    else
                                    {
                                        <img src="https://cdn.sforum.vn/sforum/wp-content/uploads/2023/10/avatar-trang-4.jpg" style="width:100%; height:100%;border-radius: 50%; " />
                                    }

                                </div>
                                <!-- /USER STATUS ACTIVITY -->
                                <!-- USER STATUS TITLE -->
                                <p class="user-status-title">

                                    @{
                                        var linkUserComment = "Route/InfomationDetail?userId=" + comment.InteractWithComments?.FirstOrDefault(o => o.InteractCommentStatus == InteractCommentStatus.Create)?.UserAccount.Id;
                                    }
                                    <a class="bold" href="@linkUserComment">
                                        @comment.InteractWithComments?.FirstOrDefault(o => o.InteractCommentStatus == InteractCommentStatus.Create)?.UserAccount.FirstName
                                        @comment.InteractWithComments?.FirstOrDefault(o => o.InteractCommentStatus == InteractCommentStatus.Create)?.UserAccount.LastName
                                    </a>
                                    @comment.Description
                                </p>
                                <!-- /USER STATUS TITLE -->
                                <!-- USER STATUS TIMESTAMP -->
                                <p class="user-status-timestamp small-space">@FormatDate.CalTimeBetweenTwoDate(comment.Created)</p>
                                <!-- /USER STATUS TIMESTAMP -->
                            </div>
                            <!-- /USER STATUS -->
                        }

                    </div>
                    <!-- /USER STATUS LIST -->
                </div>
                <!-- WIDGET BOX CONTENT -->



                <!-- WIDGET BOX Input comment -->
                <div class="chat-widget-form">
                    <!-- FORM ROW -->
                    <div class="form-row split">
                        <!-- FORM ITEM -->
                        <div class="form-item">
                            <!-- INTERACTIVE INPUT -->
                            <div class="interactive-input small">
                                <input type="hidden" id="postId_comment" name="postId" value="@Model.Id">
                                <input type="text" id="inputComment" name="description" placeholder="Write a message...">
                                
                                <!-- INTERACTIVE INPUT ICON WRAP -->
                                <div class="interactive-input-icon-wrap actionable">
                                    <!-- TOOLTIP WRAP -->
                                    <div class="tooltip-wrap text-tooltip-tft" data-title="Send Photo" style="position: relative;">
                                        <!-- INTERACTIVE INPUT ICON -->
                                        <svg class="interactive-input-icon icon-camera">
                                            <use xlink:href="#svg-camera"></use>
                                        </svg>
                                        <!-- /INTERACTIVE INPUT ICON -->
                                        <div class="xm-tooltip" style="white-space: nowrap; position: absolute; z-index: 99999; top: -28px; left: 50%; margin-left: -45.5px; opacity: 0; visibility: hidden; transform: translate(0px, 10px); transition: all 0.3s ease-in-out 0s;"><p class="xm-tooltip-text">Send Photo</p></div>
                                    </div>
                                    <!-- /TOOLTIP WRAP -->
                                </div>
                                <!-- /INTERACTIVE INPUT ICON WRAP -->
                                <!-- INTERACTIVE INPUT ACTION -->
                                <div class="interactive-input-action">
                                    <!-- INTERACTIVE INPUT ACTION ICON -->
                                    <svg class="interactive-input-action-icon icon-cross-thin">
                                        <use xlink:href="#svg-cross-thin"></use>
                                    </svg>
                                    <!-- /INTERACTIVE INPUT ACTION ICON -->
                                </div>
                                <!-- /INTERACTIVE INPUT ACTION -->
                            </div>
                            <!-- /INTERACTIVE INPUT -->
                        </div>
                        <!-- /FORM ITEM -->
                        <!-- FORM ITEM -->
                        <div class="form-item auto-width" id="buttonComment" onclick="sendComment()">
                            <!-- BUTTON -->
                            <p class="button primary padded">
                                <!-- BUTTON ICON -->
                                <svg class="button-icon no-space icon-send-message">
                                    <use xlink:href="#svg-send-message"></use>
                                </svg>
                                <!-- /BUTTON ICON -->
                            </p>
                            <!-- /BUTTON -->
                        </div>
                        <!-- /FORM ITEM -->
                    </div>
                    <!-- /FORM ROW -->
                </div>
                <!-- WIDGET BOX Input comment -->



            </div>
            <!-- /WIDGET BOX -->
        </div>
        <!-- /GRID -->
    </div>
    <!-- /GRID -->




</div>


<script>

    function sendComment() {
        var description = document.getElementsByName("description")[0].value;
        var postId = $("#postId_comment").val();
        console.log(postId);
        $.ajax({
            type: "POST",
            url: "@Url.Action("AddComment", "Post")",
            data: { postId: postId, description: description },
            success: function (result) {
                if (result.success) {
                    //alert(result.message);
                    window.location.reload();
                } else {
                    //alert(result.message);
                    window.location.href = '/login';
                }
            },
            error: function () {
                alert("Đã xảy ra lỗi khi gửi yêu cầu.");
            }
        });
    }

    function interactWithPost(postId, reactionType) {
        var reaction = reactionType;
        var statusPick = 0;
        if (reaction === "Like") {
            statusPick = 1;
        } else if (reaction === "Love") {
            statusPick = 2;
        } else if (reaction === "Dislike") {
            statusPick = 3;
        } else if (reaction === "Happy") {
            statusPick = 4;
        } else if (reaction === "Funny") {
            statusPick = 5;
        } else if (reaction === "Wow") {
            statusPick = 6;
        } else if (reaction === "Angry") {
            statusPick = 7;
        } else if (reaction === "Sad") {
            statusPick = 8;
        }
        $.ajax({
            type: "POST",
            url: "@Url.Action("InteractWithPost", "Post")",
            data: { postId: postId, status: statusPick },
            success: function (result) {
                if (result.success) {
                    // alert(result.message);
                    window.location.reload();
                } else {
                    alert(result.message);
                    window.location.href = '/login';
                }
            },
            error: function () {
                alert("Đã xảy ra lỗi khi gửi yêu cầu.");
            }
        });
    }

    function savePost(postId, statusSave) {
        $.ajax({
            type: "POST",
            url: "@Url.Action("WishListPost", "Home")",
            data: { postId: postId, isDeleted: statusSave },
            success: function (result) {
                if (result.success) {
                    //alert(result.message);
                    window.location.reload();
                } else {
                    //alert(result.message);
                    window.location.href = '/login';
                }
            },
            error: function () {
                alert("Đã xảy ra lỗi khi gửi yêu cầu.");
            }
        });
    }
   

</script>